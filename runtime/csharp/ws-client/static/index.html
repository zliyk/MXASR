<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width,initial-scale=1" />
	<title>语音识别 - MXASR</title>
	<style>
		:root {
			--primary-color: #2c3e50;
			--accent-color: #3498db;
			--light-color: #ecf0f1;
			--dark-color: #34495e;
			--success-color: #2ecc71;
			--warning-color: #f39c12;
			--danger-color: #e74c3c;
			--border-radius: 6px;
			--box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
		}

		* {
			box-sizing: border-box;
			margin: 0;
			padding: 0;
		}

		body {
			font-family: 'PingFang SC', 'Microsoft YaHei', 'Segoe UI', Arial, sans-serif;
			line-height: 1.5;
			color: var(--primary-color);
			background-color: #f8f9fa;
			padding: 1rem;
			font-size: 14px;
		}

		.container {
			max-width: 950px;
			margin: 0 auto;
			background-color: #fff;
			border-radius: var(--border-radius);
			box-shadow: var(--box-shadow);
			padding: 1rem;
		}

		h1 {
			color: var(--accent-color);
			margin-bottom: 0.3rem;
			font-size: 1.8rem;
			text-align: center;
		}

		h3 {
			color: var(--dark-color);
			margin-bottom: 0.8rem;
			font-weight: normal;
			font-size: 0.9rem;
			line-height: 1.4;
			text-align: center;
		}

		a {
			color: var(--accent-color);
			text-decoration: none;
		}

		a:hover {
			text-decoration: underline;
		}

		.grid-layout {
			display: grid;
			grid-template-columns: repeat(3, 1fr);
			gap: 0.6rem;
		}

		.grid-layout>div.full-width {
			grid-column: 1 / -1;
		}

		.grid-layout>div.half-width {
			grid-column: span 1.5;
		}

		.panel {
			border: 1px solid #ddd;
			border-radius: var(--border-radius);
			padding: 0.6rem;
			margin-bottom: 0.6rem;
			background-color: var(--light-color);
			height: 100%;
		}

		.panel-heading {
			font-size: 0.9rem;
			font-weight: bold;
			margin-bottom: 0.3rem;
			color: var(--dark-color);
		}

		input[type="text"],
		textarea,
		button,
		select {
			width: 100%;
			padding: 0.4rem 0.6rem;
			margin-bottom: 0.4rem;
			border: 1px solid #ddd;
			border-radius: var(--border-radius);
			font-family: inherit;
			font-size: 0.9rem;
		}

		input[type="file"] {
			margin: 0.3rem 0;
			font-size: 0.9rem;
		}

		textarea {
			resize: vertical;
		}

		button {
			background-color: var(--accent-color);
			color: white;
			border: none;
			cursor: pointer;
			font-weight: bold;
			transition: background-color 0.3s;
			padding: 0.4rem 0.6rem;
			font-size: 0.9rem;
		}

		button:hover {
			background-color: #2980b9;
		}

		button:disabled {
			background-color: #95a5a6;
			cursor: not-allowed;
		}

		.button-group {
			display: flex;
			gap: 0.6rem;
			margin-top: 0.4rem;
		}

		.button-group button {
			flex: 1;
		}

		#btnConnect {
			background-color: var(--primary-color);
		}

		#btnStart {
			background-color: var(--success-color);
		}

		#btnStop {
			background-color: var(--danger-color);
		}

		.radio-group {
			display: flex;
			gap: 0.8rem;
			margin: 0.3rem 0;
			font-size: 0.9rem;
		}

		.info-text {
			padding: 0.4rem 0.6rem;
			margin-bottom: 0.4rem;
			border-radius: var(--border-radius);
			background-color: #d6eaf8;
			color: var(--primary-color);
			font-size: 0.9rem;
		}

		.auth-link {
			font-size: 0.85rem;
			padding: 0.3rem 0.5rem;
			margin-bottom: 0.3rem;
			color: #2980b9;
			background-color: rgba(214, 234, 248, 0.5);
			border-radius: var(--border-radius);
			cursor: pointer;
			display: inline-block;
		}

		.auth-note {
			font-size: 0.8rem;
			color: #7f8c8d;
			margin-bottom: 0.3rem;
		}

		audio {
			width: 100%;
			margin-top: 0.4rem;
			border-radius: var(--border-radius);
			height: 30px;
		}

		.results-panel {
			margin-top: 0.6rem;
		}

		label {
			font-size: 0.9rem;
		}

		.mode-option {
			margin-top: 0.5rem;
		}

		@media (max-width: 992px) {
			.grid-layout {
				grid-template-columns: repeat(2, 1fr);
			}
		}

		@media (max-width: 768px) {
			body {
				padding: 0.3rem;
			}

			.container {
				padding: 0.6rem;
			}

			.grid-layout {
				grid-template-columns: 1fr;
			}

			.button-group {
				flex-direction: column;
			}
		}
	</style>
</head>

<body>
	<div class="container">
		<script src="recorder-core.js" charset="UTF-8"></script>
		<script src="wav.js" charset="UTF-8"></script>
		<script src="pcm.js" charset="UTF-8"></script>

		<h1>MXASR Demo</h1>
		<h3>这里是MXASR项目体验demo</h3>

		<div class="div_class_topArea">
			<div class="div_class_recordControl">
				<div class="grid-layout">
					<!-- 第一行：服务器地址 -->
					<div class="half-width">
						<div class="panel">
							<div class="panel-heading">ASR服务器地址</div>
							<input id="wssip" type="text" onchange="addresschange()"
								value="ws://124.223.76.169:10096/" />
						</div>
					</div>

					<!-- 热词设置 - 已隐藏 -->
					<div class="half-width" style="display:none;">
						<div class="panel">
							<div class="panel-heading">热词设置 (一行一个关键字，空格隔开权重)</div>
							<textarea rows="3" id="varHot">铭心云 20&#13;hello world 40</textarea>
						</div>
					</div>

					<!-- 第二行：三个选项放在一行 -->
					<!-- 选择录音模式 -->
					<div>
						<div class="panel">
							<div class="panel-heading">选择录音模式</div>
							<div class="radio-group">
								<label><input name="recoder_mode" onclick="on_recoder_mode_change()" type="radio"
										value="mic" checked="true" /> 麦克风 </label>
								<label><input name="recoder_mode" onclick="on_recoder_mode_change()" type="radio"
										value="file" /> 文件 </label>
							</div>
							<!-- 文件上传功能直接集成在录音模式面板内 -->
							<div id="rec_mode_div" class="mode-option" style="display:none;">
								<input type="file" id="upfile">
							</div>
						</div>
					</div>

					<!-- ASR模型模式 - 已隐藏 -->
					<div style="display:none;">
						<div id="mic_mode_div" class="panel">
							<div class="panel-heading">选择ASR模型模式</div>
							<div class="radio-group">
								<label><input name="asr_mode" type="radio" value="2pass" checked="true" /> 双通道
								</label>
								<label><input name="asr_mode" type="radio" value="online" /> 实时 </label>
								<label><input name="asr_mode" type="radio" value="offline" /> 离线 </label>
							</div>
						</div>
					</div>

					<!-- ITN选项 - 隐藏 -->
					<div style="display:none;">
						<div id="use_itn_div" class="panel">
							<div class="panel-heading">逆文本标准化 (ITN)</div>
							<div class="radio-group">
								<label><input name="use_itn" type="radio" value="true" checked="true" /> 是 </label>
								<label><input name="use_itn" type="radio" value="false" /> 否 </label>
							</div>
						</div>
					</div>
				</div>

				<!-- 语音识别结果 (全宽) -->
				<div class="panel results-panel">
					<div class="panel-heading">语音识别结果</div>
					<textarea rows="16" id="varArea" readonly="true"></textarea>
					<div id="info_div" class="info-text">请点击开始</div>
					<div class="button-group">
						<button id="btnConnect">连接</button>
						<button id="btnStart">开始</button>
						<button id="btnStop">停止</button>
					</div>
					<audio id="audio_record" type="audio/wav" controls></audio>
				</div>
			</div>
		</div>
	</div>

	<script src="wsconnecter.js" charset="utf-8"></script>
	<script src="main.js" charset="utf-8"></script>
	<script>
		// 页面加载完成后触发一次模式切换，确保地址正确设置
		document.addEventListener("DOMContentLoaded", function () {
			// 调用一次切换函数，确保使用正确的地址
			on_recoder_mode_change();
		});
	</script>
</body>

</html>